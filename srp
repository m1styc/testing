#include<stdio.h>
#include<string.h>
int k=0,z=0,i=0,j=0,c=0;
char a[16],ac[20],stk[15],act[10];
void check();
int main()
{
    puts("GRAMMAR is \n E->E+T \n E->T \n T->T*F \n T->F \n F->(E) \n F->id \n");
    puts("Enter input string ");
    gets(a);
    c=strlen(a);
    strcpy(act,"SHIFT->");
    puts("STACK \t INPUT \tCOMMENT");
    //puts("$ \t");
    //puts(a);
    printf("$ \t%s$\n",a); 
    for(k=0,i=0; j<c; k++,i++,j++)
    {
        if(a[j]=='i' && a[j+1]=='d')
        {
            stk[i]=a[j];
            stk[i+1]=a[j+1];
            stk[i+2]='\0';
            a[j]=' ';
            a[j+1]=' ';
            //printf("$\t%s$\n",a);
            printf("\n$%s\t%s$\t%sid",stk,a,act);
            check();
        }
        else
        {
            stk[i]=a[j];
            stk[i+1]='\0';
            a[j]=' ';
            printf("\n$%s\t%s$\t%ssymbols",stk,a,act);
            check();
        }
    }
}
void check()
{
    strcpy(ac,"REDUCE TO ");
    for(z=0; z<c; z++)
        if(stk[z]=='T' && stk[z+1]=='*' && stk[z+2]=='F')
        {
            stk[z]='T';
            stk[z+1]='\0';
            stk[z+2]='\0';
            printf("\n$%s\t%s$\t%sT",stk,a,ac);
            i=i-2;
        }
    for(z=0; z<c; z++)
        if(stk[z]=='i' && stk[z+1]=='d')
        {
            stk[z]='F';
            stk[z+1]='\0';
            printf("\n$%s\t%s$\t%sF",stk,a,ac);
            j++;
        }
    for(z=0; z<c; z++)
        if(stk[z]=='T' && stk[z+1]=='*' && stk[z+2]=='F')
        {
            stk[z]='T';
            stk[z+1]='\0';
            stk[z+2]='\0';
            printf("\n$%s\t%s$\t%sT",stk,a,ac);
            i=i-2;
        }
    for(z=0; z<c; z++)
        if(stk[z]=='F') {
            stk[z] = 'T';
            stk[z+1] = '\0';
            printf("\n$%s\t%s$\t%sT",stk,a,ac);
            return;
        }
    for(z=0; z<c; z++)
        if(stk[z]=='T' && stk[z+1]=='\0')
        {
            stk[z]='E';
            stk[z+1]='\0';
            stk[z+2]='\0';
            printf("\n$%s\t%s$\t%sE",stk,a,ac);
            i=i-2;
        }
    for(z=0; z<c; z++)
        if(stk[z]=='E' && stk[z+1]=='+' && stk[z+2]=='T')
        {
            stk[z]='E';
            stk[z+1]='\0';
            stk[z+2]='\0';
            printf("\n$%s\t%s$\t%s",stk,a,ac);
            i=i-2;
        }
    for(z=0; z<c; z++)
        if(stk[z]=='(' && stk[z+1]=='E' && stk[z+2]==')')
        {
            stk[z]='F';
            stk[z+1]='\0';
            stk[z+1]='\0';
            printf("\n$%s\t%s$\t%s",stk,a,ac);
            i=i-2;
        }
}
